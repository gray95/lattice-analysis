# script to plot t* dependece of amu
# for the 3ml mass

import matplotlib.pyplot as plt
import gvar as gv

# tmin = 2
tstar   = range(2,24)

amu_ml = gv.gvar(['5.23(26)', '5.23(26)', '5.23(26)', '5.23(26)', '5.22(26)', '5.19(26)', '5.15(27)', '5.11(28)', '5.07(31)', '4.96(39)', '4.77(48)', '4.83(65)', '4.62(80)', '4.1(1.1)', '3.5(1.3)', '2.6(1.7)', '2.6(2.1)', '3.0(2.5)', '3.8(2.9)', '2.3(3.4)', '3.6(3.9)', '3.8(4.6)'])
#amu_ml_mom = gv.gvar(['5.23(26)', '5.23(26)', '5.23(26)', '5.23(26)', '5.22(26)', '5.19(26)', '5.16(27)', '5.11(28)', '5.07(31)', '4.97(39)', '4.78(47)', '4.84(64)', '4.64(78)', '4.1(1.1)', '3.6(1.3)', '2.6(9.4)']) 
amu_3ml = gv.gvar(['5.01(14)', '5.00(14)', '5.00(14)', '5.01(14)', '5.00(14)', '5.00(14)', '4.98(14)', '4.97(14)', '4.97(14)', '4.98(14)', '5.02(15)', '5.08(16)', '5.13(18)', '5.17(20)', '5.15(22)', '5.12(25)', '5.09(27)', '5.12(30)', '5.18(33)', '5.16(36)', '5.25(39)', '5.32(42)' ])
amu_5ml = gv.gvar(['4.678(81)', '4.678(81)', '4.677(81)', '4.678(81)', '4.674(81)', '4.672(82)', '4.660(83)', '4.650(83)', '4.652(84)', '4.655(86)', '4.686(91)', '4.721(95)', '4.76(10)', '4.80(11)', '4.81(11)', '4.81(12)', '4.82(13)', '4.83(14)', '4.84(15)', '4.85(15)', '4.87(16)', '4.89(17)'])
amu_7ml = gv.gvar(['4.399(63)', '4.399(63)', '4.398(63)', '4.399(63)', '4.393(63)' , '4.394(63)', '4.386(63)', '4.379(64)', '4.380(65)', '4.380(66)', '4.399(68)', '4.417(70)', '4.440(72)', '4.463(74)', '4.475(77)', ' 4.480(80)', '4.487(83)', '4.491(85)', '4.492(87)', '4.500(89)', '4.504(91)', '4.515(93)'])
#######################################################################################
## RATIOs ########################################
amu_ml_ratio = gv.gvar(['1.021(65)', '1.022(65)', '1.022(65)', '1.022(65)', '1.024(65)', '1.020(66)', '1.022(68)', '1.016(72)', '1.017(84)', '1.01(11)', '1.01(14)', '1.01(19)', '1.00(24)', '1.00(36)', '0.99(52)', '0.96(87)', '0.9(1.0)', '0.9(1.1)', '1.0(1.1)', '1.1(2.1)', '1.2(1.6)', '1.2(1.8)'])
amu_3ml_ratio = gv.gvar(['1.006(36)', '1.006(35)', '1.006(35)', '1.006(36)', '1.006(35)', '1.006(35)', '1.006(36)', '1.006(36)', '1.005(36)', '1.005(37)', '1.004(41)', '1.003(44)', '1.002(47)', '1.001(53)', '1.001(58)', '1.000(66)', '1.001(75)', '1.001(83)', '1.002(90)', '1.00(10)', '1.00(10)', '1.00(11)'])
amu_5ml_ratio = gv.gvar(['1.000(20)', '1.000(20)', '1.000(20)', '1.000(20)', '1.000(20)', '1.000(20)', '1.001(20)', '1.001(20)', '1.001(21)', '1.001(21)', '1.001(23)', '1.001(24)', '1.000(26)', '1.000(28)', '0.999(30)', '0.999(33)', '0.999(35)', '0.999(38)', '1.000(40)', '1.000(42)', '1.000(44)', '0.999(46)'])
amu_7ml_ratio =  gv.gvar(['0.999(14)', '0.999(14)', '0.999(14)', '1.000(14)', '1.000(14)', '1.000(14)', '1.000(14)', '1.001(14)', '1.001(15)', '1.001(15)', '1.001(16)', '1.001(17)', '1.000(18)', '1.000(18)', '0.999(19)', '0.999(20)', '0.999(21)', '0.999(22)', '0.999(23)', '0.999(24)', '0.999(24)', '0.999(25)'])
amu_ml_dan_ratio = gv.gvar(['0.999(76)', '0.999(76)', '0.999(76)', '0.997(77)', '0.995(77)', '0.983(78)', '0.976(81)', '0.950(88)', '0.92(10)', '0.92(12)', '0.82(14)', '0.83(18)', '0.78(22)', '0.83(31)', '0.89(35)', '1.00(39)'])


###############################################################################
## Plotting begins here##

fig, ax = plt.subplots(figsize=(10,7))
ax.set_yscale('linear')
plt.rc('font', **{'family': 'serif', 'serif': ['Computer Modern'],'size':16})
plt.rc('text', usetex=True)
plt.rc('axes', linewidth=0.5)

#ax.errorbar([t for t in tstar], [y.mean for y in amu_7ml_ratio], xerr=0, yerr=[y.sdev for y in amu_7ml_ratio], fmt='h',mfc='none',color='red',lw=1, label='7ml', alpha=0.8)

#ax.errorbar([t+0.05 for t in tstar], [y.mean for y in amu_5ml_ratio], xerr=0, yerr=[y.sdev for y in amu_5ml_ratio], fmt='h',mfc='none',color='orange',lw=1, label='5ml', alpha=0.8)

#ax.errorbar([t-0.05 for t in tstar], [y.mean for y in amu_3ml_ratio], xerr=0, yerr=[y.sdev for y in amu_3ml_ratio], fmt='h',mfc='none',color='blue',lw=1, label='3ml', alpha=0.8)

ax.errorbar([t+0.05 for t in tstar], [y.mean for y in amu_ml_ratio], xerr=0, yerr=[y.sdev for y in amu_ml_ratio], fmt='h',mfc='none',color='green',lw=1, label='our ml (185 cfgs)', alpha=0.8)
ax.errorbar([t-0.05 for t in tstar[2:-4]], [y.mean for y in amu_ml_dan_ratio], xerr=0, yerr=[y.sdev for y in amu_ml_dan_ratio], fmt='h',mfc='none',color='red',lw=1, label='dan ml (127 cfgs)', alpha=0.8)


ax.set_xlabel(r'$t^*$', fontsize=22)
ax.set_ylabel(r'$\frac{a_{\mu}^{QCD+QED}}{a_{\mu}^{QCD}}$', fontsize=16, rotation=0, labelpad=20)
ax.legend(frameon=False,fontsize=12,loc='upper left')
plt.ylim(bottom=0.8, top=1.2)
plt.savefig('tstarDep_cfRatioWithDan.png', dpi=600, bbox_inches="tight")
plt.tight_layout()
plt.show()

plt.close()
