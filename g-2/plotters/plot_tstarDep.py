# script to plot t* dependece of various quantities 

import matplotlib.pyplot as plt
import gvar as gv

# tmin = 2
tstar   = range(1,20)

amu_ml = gv.gvar(['5.24(24)','5.24(24)','5.24(24)','5.25(24)','5.25(25)','5.22(25)','5.21(25)','5.15(26)','5.11(29)','5.01(36)','4.81(43)','4.86(59)','4.63(72)','4.09(96)','3.4(1.2)','2.5(1.5)','2.4(1.9)','2.8(2.2)','3.9(2.6)'])
amu_3ml = gv.gvar(['4.96(11)','4.96(11)','4.96(11)','4.96(11)','4.96(11)','4.95(11)','4.94(11)','4.93(11)','4.95(11)','4.96(12)','5.01(13)','5.07(15)','5.12(17)','5.16(19)','5.14(21)','5.11(24)','5.08(26)','5.12(29)','5.18(32)'])
amu_5ml = gv.gvar(['4.671(73)','4.671(73)','4.671(73)','4.671(73)','4.668(73)','4.668(73)','4.661(74)','4.654(75)','4.659(77)','4.662(80)','4.693(86)','4.726(91)','4.761(98)','4.80(10)','4.81(11)','4.81(12)','4.82(13)','4.83(14)','4.84(14)'])
amu_7ml = gv.gvar(['4.379(57)','4.379(57)','4.379(57)','4.379(57)','4.377(57)','4.377(57)','4.373(58)','4.368(58)','4.371(60)','4.372(61)','4.392(64)','4.411(66)','4.434(69)','4.457(72)','4.468(75)','4.474(78)','4.482(81)','4.486(83)','4.487(85)'])
#######################################################################################
## RATIOs ########################################
amu_ml_ratio = gv.gvar(['0.993(10)','0.993(10)','0.993(10)','0.993(10)','0.993(10)','0.994(10)','0.994(11)','0.997(11)','0.997(13)','1.003(15)','0.999(19)','1.002(26)','0.997(34)','0.993(51)','0.983(70)','0.96(12)','0.94(14)','0.92(15)','1.02(18)'])
amu_3ml_ratio = gv.gvar(['1.0019(14)','1.0019(14)','1.0019(14)','1.0019(14)','1.0020(14)','1.0021(14)','1.0022(14)','1.0023(15)','1.0023(15)','1.0023(16)','1.0018(16)','1.0015(18)','1.0010(19)','1.0005(23)','1.0002(27)','0.9994(32)','1.0003(37)','1.0005(42)','1.0015(48)'])
amu_5ml_ratio = gv.gvar(['0.99973(63)','0.99973(63)','0.99974(63)','0.99975(63)','0.99978(63)','0.99983(63)','0.99990(62)','0.99996(63)','0.99997(64)','1.00002(66)','0.99987(69)','0.99968(73)','0.99943(78)','0.99908(87)','0.99887(98)','0.9987(11)','0.9989(13)','0.9992(14)','0.9995(15)'])
amu_7ml_ratio =  gv.gvar(['0.99947(34)','0.99947(34)','0.99947(34)','0.99948(34)','0.99950(34)','0.99951(33)',' 0.99953(33)','0.99956(34)','0.99954(34)','0.99955(36)','0.99945(38)','0.99932(40)','0.99915(43)','0.99893(47)','0.99880(52)','0.99873(59)','0.99882(64)','0.99892(70)','0.99905(74)'])


###############################################################################
## Plotting begins here##

fig, ax = plt.subplots(figsize=(10,7))
ax.set_yscale('linear')
plt.rc('font', **{'family': 'serif', 'serif': ['Computer Modern'],'size':16})
plt.rc('text', usetex=True)
plt.rc('axes', linewidth=0.5)

ax.errorbar([t+0.1 for t in tstar], [(y.sdev/y.mean) for y in amu_7ml], xerr=0, yerr=0, fmt='h',mfc='none',color='red',lw=1, label='7ml', alpha=0.8)

ax.errorbar([t+0.03 for t in tstar], [(y.sdev/y.mean) for y in amu_5ml], xerr=0, yerr=0, fmt='h',mfc='none',color='orange',lw=1, label='5ml', alpha=0.8)

ax.errorbar([t-0.03 for t in tstar], [(y.sdev/y.mean) for y in amu_3ml], xerr=0, yerr=0, fmt='h',mfc='none',color='green',lw=1, label='3ml', alpha=0.8)

#ax.errorbar([t-0.1 for t in tstar], [(y.sdev/y.mean) for y in amu_ml], xerr=0, yerr=0, fmt='h',mfc='none',color='blue',lw=1, label='mu,md', alpha=0.7)


ax.set_xlabel(r'$t^*/a$', fontsize=16)
ax.set_ylabel(r'error/mean in $a_{\mu}$', fontsize=14)
ax.legend(frameon=False,fontsize=12,loc='upper left')
#plt.ylim(bottom=4, top=6)
plt.savefig('tstarDep_amu_fracerror_zoom.png', dpi=600, bbox_inches="tight")
plt.tight_layout()
plt.show()

plt.close()
